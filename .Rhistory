ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.8)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 2)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 2.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5, nudge_y = 0.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.1)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 0.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5, nudge_y = 0.2)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5, nudge_y = -0.2)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = -1.5,)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black',)
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 0.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_text_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_text_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method='loess', span=1.6) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
gridExtra::grid.arrange(sub2, sub3, sub1, ncol=2, nrow=2)
findexChart1
summary(findexChart1)
View(findexChart1)
findexChart1 <- dplyr::rename(findexChart1,  Account.(%.age.15+) = acct.%)
findexChart1 <- dplyr::rename(findexChart1,  'Account.(%.age.15+)' = acct.%)
summary(findexChart1)
findexChart1 <- dplyr::rename(findexChart1,  'Account.(%.age.15+)' = 'acct.%')
#Financial Inclusion Chart 1
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
findexChart1 <- dplyr::rename(findexChart1,  'Account.(%.age.15+)' = acct.perc)
?rename()
findexChart1 <- dplyr::rename(findexChart1,  'Account.(%.age.15+)' = 'acct.perc')
summary(findexChart1)
findexChart1 <- dplyr::rename(findexChart1,  var6 = acct.perc)
findexChart1 <- dplyr::rename(findexChart1, acct.perc = 'Account.(%.age.15+)')
summary(findexChart1)
#Financial Inclusion Chart 1
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
fchart1 <- ggplot(findexChart1, aes(x='Account.(%.age.15+)', y = x1)) +
geom_point()
findexChart1
fchart1
fchart1 <- ggplot(findexChart1, aes(x='Account.(%.age.15+)', y = X1)) +
geom_point()
fchart1
summary(findexChart1)
str(findexChart1)
fchart1 <- ggplot(findexChart1, aes(x='Account.(%.age.15+)', y = X3)) +
geom_point(aes(color = X1)) +
geom_line(aes(group = X1))
fchart1
fchart1 <- ggplot(findexChart1, aes(y='Account.(%.age.15+)', x = X3)) +
geom_point(aes(color = X1)) +
geom_line(aes(group = X1))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=x1, y=X3)) +
geom_point(aes(color = X1)) +
geom_line(aes(group = 'Account.(%.age.15+)'))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=x3, y='Account.(%.age.15+)')) +
geom_point()
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X3, y='Account.(%.age.15+)')) +
geom_point()
fchart1
summary(findexChart1$`Account.(%.age.15+)`)
str(findexChart1$`Account.(%.age.15+)`)
findexChart1 <- dplyr::transmute(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fchart1 <- ggplot(findexChart1, aes(x=X3, y='Account.(%.age.15+)')) +
geom_point()
fchart1
str(findexChart1)
?transmute
#Financial Inclusion Chart 1
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
findexChart1 <- dplyr::mutate(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fchart1 <- ggplot(findexChart1, aes(x=X3, y='Account.(%.age.15+)')) +
geom_point()
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y='Account.(%.age.15+)')) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y='Account.(%.age.15+)', color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)``, color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
str(findexChart1)
findexChart1 <- dplyr::mutate(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y='Account.(%.age.15+)', color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
str(findexChart1)
findexChart1 <- dplyr::mutate(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fchart1 <- ggplot(findexChart1, aes(x=X1, y='Account.(%.age.15+)', color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3, size = 1))
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1.5)
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1.2)
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1.1)
fchart1
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart1
gridExtra::grid.arrange(sub2, sub3, sub1, ncol=2, nrow=2)
sub1
gridExtra::grid.arrange(sub2, sub3, ncol=2)
sub1
sub1 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col(aes(fill=fr)) +
scale_fill_gradient(low ='grey', high ='#5077BD')
sub1
sub1
sub1 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col(aes(fill=fr)) +
coord_flip() +
scale_fill_gradient(low ='grey', high ='#5077BD')
sub1
sub1 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col(aes(fill=fr)) +
coord_flip() +
scale_fill_gradient(low ='grey', high ='#5077BD')
sub1
gridExtra::grid.arrange(sub2, sub3, ncol=2)
sub1
#Financial Inclusion Chart 2 - Pop up from Fiber Front Page
findexChart2 <- subset (asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart2
summary(findexChart2)
str(findexChart2)
findexChart2 <- findexChart2[,c(1:29,770:781)]
str(findexChart2)
findexChart2 <- dplyr::mutate(findexChart2,
`Mobile.money.account.(%.age.15+)`=`Mobile.money.account.(%.age.15+)`*100)
fChart2 <- ggplot(findexChart1, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
library(ggplot2)
fChart2 <- ggplot(findexChart1, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
fChart2 <- ggplot(findexChart1, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
#Financial Inclusion Chart 1 (% of Adults with an Account, 2011-2017)
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
str(findexChart1)
findexChart1 <- dplyr::mutate(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fChart2 <- ggplot(findexChart1, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart1
#Financial Inclusion Chart 2 - Pop up from Fiber Front Page
findexChart2 <- subset (asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart2 <- findexChart2[,c(1:29,770:781)]
findexChart2 <- dplyr::mutate(findexChart2,
`Mobile.money.account.(%.age.15+)`=`Mobile.money.account.(%.age.15+)`*100)
fChart2 <- ggplot(findexChart1, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
fChart2 <- ggplot(findexChart2, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
#Financial Inclusion Chart 2 - Pop up from Fiber Front Page
findexChart2 <- subset (asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart2 <- findexChart2[,c(1:29,770:781)]
findexChart2 <- dplyr::mutate(findexChart2,
`Mobile.money.account.(%.age.15+)`=`Mobile.money.account.(%.age.15+)`*100)
fChart2 <- ggplot(findexChart2, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
View(fChart2)
View(fchart1)
fchart2 <- ggplot(findexChart2, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
#Load Required Packages
library(openxlsx)
library(ggplot2)
library(plyr)
#Import Data
findexPage1 <- read.xlsx("findex-data/globalFindexdatabase.xlsx", sheet=1)
providers <- read.csv('findex-data/provider_metrics.csv')
str(findexPage1$X4)
summary(findexPage1$X3)
#Subseting Data for Asia Only
asiaFindex <- subset(findexPage1, X4 == "South Asia")
asiaFindex
#Dummy Data Donut Chart
asiaDonut <- data.frame(count=c(28, 72), category=c('A', 'B'))
asiaDonut$fraction = asiaDonut$count / sum(asiaDonut$count)
asiaDonut = asiaDonut[order(asiaDonut$fraction), ]
asiaDonut$ymax = cumsum(asiaDonut$fraction)
asiaDonut$ymin = c(0, head(asiaDonut$ymax, n=-1))
p1 <- ggplot(asiaDonut, aes(fill=category, ymax=ymax, ymin=ymin, xmax=4, xmin=3)) +
geom_rect(colour="grey30") +
coord_polar(theta="y") +
xlim(c(0, 4)) +
theme_bw() +
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
scale_fill_manual(values = c('#e0e0e0','#0D6EB8')) +
labs(title="South Asia: Fiber Reach (%)")
p1
#Donut Chart for Each Country
#Dummy Data Fiber Reach Bar Chart
asiaFRbar <- data.frame(value=c(40, 62, 34, 60, 45, 75, 80, 68),
country=c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
p2 <- ggplot(asiaFRbar, aes(country, value)) +
geom_col( aes(fill=country)) +
scale_fill_brewer(palette = 'Set2') +
geom_hline(yintercept=72, color='#0D6EB8', size=1.5) +
coord_flip() +
scale_y_continuous(limits = c(0,90), expand = c(0, 0))
p2
#Providers By Country Bar Chart
asiaProviders <- subset(providers, continent == 'Asia')
asiaProviders <- asiaProviders[c(3:6)]
asiaProviders <- count(asiaProviders, "country")
asiaProviders <- asiaProviders[asiaProviders$country %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),]
asiaProviders
p3 <- ggplot(asiaProviders, aes(country, freq)) +
geom_col(aes(fill=country)) +
scale_fill_brewer(palette = 'Set2') +
scale_y_continuous(limits = c(0,11), expand = c(0, 0)) +
coord_flip()
p3
#Health Scatterplot
asiaScatter <- read.csv("findex-data/final.csv", TRUE, sep =",")
asiaScatter <- dplyr::rename(asiaScatter, country = ï..Country)
asiaScatter <- dplyr::transmute(asiaScatter,
country=country,FB.Growth.Rate=FB.Growth.Rate*100,IMR=IMR*100,LE.Rate=LE.Rate*100)
asiaScatter <- subset(asiaScatter, country %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
p4 <- ggplot(asiaScatter, aes(x=FB.Growth.Rate, y=IMR, color=LE.Rate)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='#65C7F7', high ='#5077BD') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 1.5)
p4
#Financial Inclusion Chart 1 (% of Adults with an Account, 2011-2017)
findexChart1 <- subset(asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart1 <- findexChart1[,c(1:29,770:781)]
str(findexChart1)
findexChart1 <- dplyr::mutate(findexChart1,
`Account.(%.age.15+)`=`Account.(%.age.15+)`*100)
fchart1 <- ggplot(findexChart1, aes(x=X1, y=`Account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart1
#Financial Inclusion Chart 2 - Pop up from Fiber Front Page
findexChart2 <- subset (asiaFindex, X3 %in%
c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'))
findexChart2 <- findexChart2[,c(1:29,770:781)]
findexChart2 <- dplyr::mutate(findexChart2,
`Mobile.money.account.(%.age.15+)`=`Mobile.money.account.(%.age.15+)`*100)
fchart2 <- ggplot(findexChart2, aes(X1, y=`Mobile.money.account.(%.age.15+)`, color=X3)) +
geom_point() +
geom_line(aes(group=X3), size = 1)
fchart2
#WorldBank Data
asiaBroadband <- wbstats::wb(country = c('AFG', 'BGD', 'BTN', 'IND', 'MDV', 'NPL', 'PAK', 'LKA'),
indicator = 'IT.NET.BBND.P2', mrv = 5)
asiaIMR <- wbstats::wb(country = c('AFG', 'BGD', 'BTN', 'IND', 'MDV', 'NPL', 'PAK', 'LKA'),
indicator = 'SP.DYN.IMRT.IN', mrv = 5)
asiaLE <- wbstats::wb(country = c('AFG', 'BGD', 'BTN', 'IND', 'MDV', 'NPL', 'PAK', 'LKA'),
indicator = 'SP.DYN.LE00.IN', mrv = 5)
asiaBroadband
asiaIMR
asiaLE
#Health Plots
p5 <- ggplot(asiaBroadband, aes(x = date, y = value, color = country)) +
geom_line(aes(group = country), size = 1.2) +
geom_point() +
scale_color_brewer(palette = 'Set2') +
scale_x_discrete(limits = c('2013', '2014', '2015', '2016', '2017'), expand = c(0,0))
p5
p6 <- ggplot(asiaIMR, aes(x = date, y = value, color = country)) +
geom_line(aes(group = country), size = 1.2) +
geom_point() +
scale_color_brewer(palette = 'Set2') +
scale_x_discrete(limits = c('2013', '2014', '2015', '2016', '2017'), expand = c(0,0))
p6
p7 <- ggplot(asiaLE, aes(x = date, y = value, color = country)) +
geom_line(aes(group = country), size = 1.2) +
geom_point() +
scale_color_brewer(palette = 'Set2') +
scale_x_discrete(limits = c('2013', '2014', '2015', '2016', '2017'), expand = c(0,0))
p7
#Comparing
gridExtra::grid.arrange(p5, p6, p7, p4, ncol=2, nrow=2)
#Networks by Department (See Operator Dashboard)
bangladeshProviders <- read.csv('findex-data/provider_metrics.csv')
bangladeshProviders <- subset(bangladeshProviders, country == 'Bangladesh')
bangladeshProviders <- bangladeshProviders[,4:6]
bangladeshProviders
sub1 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col(aes(fill=fr)) +
coord_flip() +
scale_fill_gradient(low ='grey', high ='#5077BD')
sub1
sub2 <- ggplot(bangladeshProviders, aes(x=provider, y=fr)) +
geom_col() +
coord_flip()
sub2
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip ()
sub3
gridExtra::grid.arrange(sub2, sub3, ncol=2)

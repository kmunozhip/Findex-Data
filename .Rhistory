coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,175000), expand = c(0,0))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,180000), expand = c(0,0))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,0))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,10000))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,1000))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,1500))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,2000))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,2500))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,3000))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,4000))
sub4
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,0))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,20000), expand = c(0,0))
sub3
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,2000), expand = c(0,0))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,20000), expand = c(0,0))
sub3
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,1000))
sub4
sub4 <- ggplot(bangladeshAdm3, aes(name_1, popden)) +
geom_col() +
coord_flip() +
labs(x='Adminstrative Division 1', y='Number of Banks') +
scale_y_continuous(limits = c(0,200000), expand = c(0,5000))
sub4
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,2000))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,1000))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,0))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,100))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,150))
sub3
sub3 <- ggplot(bangladeshProviders, aes(x=provider, y=dist)) +
geom_col (fill='grey') +
coord_flip () +
labs(x='Provider' , y='Fiber Distance (km)') +
scale_y_continuous(limits = c(0,10000), expand = c(0,250))
sub3
sub4
sub5
sub5 <- ggplot(bangladeshAdm3, aes(name_1, no_banks)) +
geom_col(fill='grey') +
coord_flip() +
labs(x='Administrative Division 1', y='Population Density') +
scale_y_continuous(limits = c(0,3000), expand = c(0,100))
sub5
bangladeshProviders
str(bangladeshAdm3$name_1)
summary(bangladeshAdm3$name_1)
bangladeshAdm3
bangladeshAdm3
gridExtra::grid.arrange(sub4, sub5, ncol=2)
long_asiaIMR
long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE)
long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, value)
long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
long_asiaIMR
rate_imr <- long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
#Health Scatterplot: R Analysis & Data Manipulation
asiaIMR %>%
group_by(country) %>%
summarise(avg_imr = mean(value, na.rm = TRUE))
#Health Scatterplot: R Analysis & Data Manipulation
asiaIMR %>%
group_by(country) %>%
summarise(avg_imr = mean(value, na.rm = TRUE))
long_asiaIMR
rate_imr
#LE
long_asiaLE <- asiaLE %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaLe
long_asiaLE
long_asiaLE
long_asiaLE <-long_asiaLE %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
long_asiaLE
rate_le <- long_asiaLE %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
long_asiaLE
rate_le
asiafbfr
asiaBroadband
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
#FB
long_asiaBroadband <- asiaBroadband %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
long_asiaBroadband
rate_asiabroadband <- long_asiaBroadband %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
long_asiaBroadband
rate_asiabroadband
asiaScatter
?merge
#Joining it all
asiaScatter <- merge(rate_asiabroadband, rate_imr, by.x = country, by.y = country)
rate_asiabroadband
rate_asiabroadband
reate_le
rate_le
#Joining it all
asiaScatter <- merge(rate_asiabroadband, rate_imr, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter
asiaScatter <- merge(asiaScatter, rate_le, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter
#LE
long_asiaLE <- asiaLE %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaLE <-long_asiaLE %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_le <- long_asiaLE %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_le)
long_asiaLE
rate_le
#FB
long_asiaBroadband <- asiaBroadband %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_asiabroadband <- long_asiaBroadband %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_bb)
long_asiaBroadband
rate_asiabroadband
#Joining it all
asiaScatter <- merge(rate_asiabroadband, rate_imr, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter <- merge(asiaScatter, rate_le, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter <- rename(asiaScatter, avg_imr = 'avg_imr.x', avg_imr)
asiaScatter <- rename(asiaScatter, avg_imr = 'avg_imr.x')
asiaScatter <- rename(asiaScatter, 'avg_imr' = avg_imr.x)
asiaScatter
asiaScatter
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_le)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black', nudge_x = 0.8)
p4
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_le)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
asiaScatter
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_le, color=avg_imr)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_le)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
rate_imr
long_asiaLE
bangladeshAdm3
bangladeshAdm3$name_1
str(bangladeshAdm3)
asiaProviders
providers
View(bangladeshProviders)
summary(bangladeshAdm3)
long_asiaIMR
#IMR
long_asiaIMR <- asiaIMR %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaIMR
long_asiaIMR <- long_asiaIMR %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
long_asiaIMR
rate_imr <- long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
rate_imr
asiaScatter
#FB
long_asiaBroadband <- asiaBroadband %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
long_asiaBroadband
long_asiaIMR <- asiaIMR %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaIMR <- long_asiaIMR %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_imr <- long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_imr)
long_asiaIMR
rate_imr
#LE
long_asiaLE <- asiaLE %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaLE <-long_asiaLE %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_le <- long_asiaLE %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_le)
long_asiaLE
rate_le
#FB
long_asiaBroadband <- asiaBroadband %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_asiabroadband <- long_asiaBroadband %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(mean), na.rm = TRUE) %>%
gather(country, avg_bb)
long_asiaBroadband
rate_asiabroadband
#Joining it all
asiaScatter <- merge(rate_asiabroadband, rate_imr, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter <- merge(asiaScatter, rate_le, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_le)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
#Comparing
gridExtra::grid.arrange(p5, p6, p7, p4, ncol=2, nrow=2)
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_le, color=avg_imr)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
#IMR
long_asiaIMR <- asiaIMR %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaIMR <- long_asiaIMR %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_imr <- long_asiaIMR %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(median), na.rm = TRUE) %>%
gather(country, avg_imr)
long_asiaIMR
rate_imr
#LE
long_asiaLE <- asiaLE %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaLE <-long_asiaLE %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_le <- long_asiaLE %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(median), na.rm = TRUE) %>%
gather(country, avg_le)
long_asiaLE
rate_le
#FB
long_asiaBroadband <- asiaBroadband %>%
select(c(2,3,7)) %>%
spread(date, value)
long_asiaBroadband <- long_asiaBroadband %>%
mutate(diff1 = `2013`-`2012`,
diff2 = `2014`-`2013`,
diff3 = `2015`-`2014`,
diff4 = `2016`-`2015`) %>%
select(1, 8:11)
rate_asiabroadband <- long_asiaBroadband %>%
gather(year, value, diff1, diff2, diff3, diff4) %>%
spread(country, value) %>%
summarise_at(c('Afghanistan', 'Bangladesh', 'Bhutan', 'India', 'Maldives', 'Nepal', 'Pakistan', 'Sri Lanka'),
funs(median), na.rm = TRUE) %>%
gather(country, avg_bb)
long_asiaBroadband
rate_asiabroadband
#Joining it all
asiaScatter <- merge(rate_asiabroadband, rate_imr, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter <- merge(asiaScatter, rate_le, by.x = 'country', by.y = 'country', all.x = TRUE)
asiaScatter
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_le, color=avg_imr)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_bb)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
p4 <- ggplot(asiaScatter, aes(x=avg_bb, y=avg_imr, color=avg_le)) +
geom_point(size=5)+
geom_smooth(se=FALSE, color="black", linetype="solid", method=lm) +
scale_color_gradient(low ='dodgerblue', high ='black') +
ggrepel::geom_label_repel(data=asiaScatter,
aes(label = asiaScatter$country), direction='both', color = 'black')
p4
?rmarkdown
sub2
sub3
sub4
